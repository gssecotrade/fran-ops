name: Fran Ops — Scheduler

on:
  schedule:
    - cron: "35 8 * * *"   # 08:35 UTC (ajusta si quieres)
  workflow_dispatch: {}

jobs:
  run:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install deps
        run: |
          python -m pip install --upgrade pip
          pip install requests beautifulsoup4

      - name: Fetch LAE latest -> JSON
        run: |
          python ops/scripts/fetch_lae_latest.py
          ls -l dist/

      - name: Copy JSON into docs/api/
        run: |
          mkdir -p docs/api
          cp dist/lae_latest.json docs/api/lae_latest.json

      - name: Auto-commit lae_latest.json (pages)
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "chore: update docs/api/lae_latest.json"
          branch: main
          file_pattern: docs/api/lae_latest.json

      # Tu pipeline principal puede seguir (csv, normalización, zips, etc.)
      # ...
